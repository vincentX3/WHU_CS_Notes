# 存储器管理

## 0. 引入
> 改革开放春风吹满地，人民手头钱多了，但人们没有感到暴富。因为物质需求同时也在增长。

👆存储器管理也是这般。纵然存储空间越来越大，各种软件所需资源也同时膨胀。so 对存储器管理，就是“用好手头的钱，想办法得到更多的钱”。

- 存储器划分：
    系统区（OS用）／用户区（可多个，供用户进程用）

- 功能：
    1. 分配&回收
    2. 抽象&映射（逻辑地址→物理地址）
    3. 内存扩充 （逻辑扩充）
    4. 存储保护

## 1. 基本概念
源程序→可执行程序，一般历经：
> 1）编译 → 2）链接 → 3）装入
### 1.1 程序装入

#### 绝对装入方式
编译时产生**绝对地址**的目标代码，装入该地址
（逻辑地址==绝对地址）

*适用于单道程序*
#### 可重定位装入方式
编译时产生**逻辑地址**的目标代码，装入时进行**地址映射**
- 绝对地址=逻辑地址 + 程序基地址
- 地址变换转入时**一次完成**

👆一次性装入，当程序较大时代码利用率低，装入过多“短时间内”不使用的代码
#### 动态运行时装入方式
装入内存时不地址变换，在程序执行过程中进行地址变换
- 需硬件支持
- 可**部分**装入
- 可将程序分配到**不连续**的内存

### 1.2 程序链接
- 静态链接：
    运行前装配为完整装入模块

- 装入时动态链接：
    目标模块在装入内存时**边装入边链接**。
    特点：便于软件版本的修改和更新，便于目标模块的共享
    缺点：不可预知要运行的模块。导致每次装入模块都**相同**（保证完整、可用的妥协）

- 运行时动态链接：
    **执行**过程中，若发现被调用模块尚未装入内存，OS才进行寻找、装入、链接该模块
    特点：加快程序装入，节省内存。


### 1.3 内存保护

#### 界限保护
1. 上下界寄存器
2. 基址、限长寄存器

#### 访问方式保护
锁与钥匙：
存储块： 分配专属保护键（block）
进程： 赋予保护键（key）

#### 环保护
划分**特权级**